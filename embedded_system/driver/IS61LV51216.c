#include "IS61LV51216.h"
#include "sys.h"

//tHCLK=6ns
void IS62WV51216_Init(void)
{
	RCC->AHB1ENR|=1<<3;	//GPIOD
	RCC->AHB1ENR|=1<<4;	//GPIOE
	RCC->AHB1ENR|=1<<5;	//GPIOF
	RCC->AHB1ENR|=1<<6;	//GPIOG
	RCC->AHB3ENR|=1;	//FSMC时钟使能
	
	GPIO_AF_Set(GPIOG,10,12);
	
	GPIO_Set(GPIOG,PIN10,GPIO_MODE_AF,GPIO_OTYPE_OD,
				GPIO_SPEED_100M,GPIO_PUPD_NONE);	//NE3
	GPIO_Set(GPIOD,PIN4|PIN5,GPIO_MODE_AF,GPIO_OTYPE_PP,
				GPIO_SPEED_100M,GPIO_PUPD_PU);		//NWE,NOE
	GPIO_Set(GPIOE,PIN0|PIN1,GPIO_MODE_AF,GPIO_OTYPE_PP,
				GPIO_SPEED_100M,GPIO_PUPD_PU);		//NBL0,NBL1
	
	/*D2,3,13,14,15,0,1*/
	GPIO_Set(GPIOD,PIN0|PIN1|PIN8|PIN9|PIN10|PIN14|PIN15,GPIO_MODE_AF,
				GPIO_OTYPE_PP,GPIO_SPEED_100M,GPIO_PUPD_PU);
	
	/*D4,5,6,7,8,9,10,11,12*/
	GPIO_Set(GPIOE,PIN7|PIN8|PIN9|PIN10|PIN11|PIN12|PIN13|PIN14|PIN15,
				GPIO_MODE_AF,GPIO_OTYPE_PP,GPIO_SPEED_100M,GPIO_PUPD_PU);
	
	/*A16,17,18*/
	GPIO_Set(GPIOD,PIN11|PIN12|PIN13,GPIO_MODE_AF,GPIO_OTYPE_PP,
				GPIO_SPEED_100M,GPIO_PUPD_PU);
		
	/*A0,1,2,3,4,5,6,7,8,9*/
	GPIO_Set(GPIOF,PIN0|PIN1|PIN2|PIN3|PIN4|PIN5|PIN12|PIN13|PIN14|PIN15,
				GPIO_MODE_AF,GPIO_OTYPE_PP,GPIO_SPEED_100M,GPIO_PUPD_PU);
		
	/*A10,11,12,13,14,15*/
	GPIO_Set(GPIOG,PIN0|PIN1|PIN2|PIN3|PIN4|PIN5,GPIO_MODE_AF,GPIO_OTYPE_PP,
				GPIO_SPEED_100M,GPIO_PUPD_PU);
	
	GPIO_AF_Set(GPIOD,0,12);
	GPIO_AF_Set(GPIOD,1,12);
	GPIO_AF_Set(GPIOD,4,12);
	GPIO_AF_Set(GPIOD,5,12);
	GPIO_AF_Set(GPIOD,8,12);
	GPIO_AF_Set(GPIOD,9,12);
	GPIO_AF_Set(GPIOD,10,12);
	GPIO_AF_Set(GPIOD,11,12);
	GPIO_AF_Set(GPIOD,12,12);
	GPIO_AF_Set(GPIOD,13,12);
	GPIO_AF_Set(GPIOD,14,12);
	GPIO_AF_Set(GPIOD,15,12);
	
	GPIO_AF_Set(GPIOE,0,12);
	GPIO_AF_Set(GPIOE,1,12);
	GPIO_AF_Set(GPIOE,7,12);
	GPIO_AF_Set(GPIOE,8,12);
	GPIO_AF_Set(GPIOE,9,12);
	GPIO_AF_Set(GPIOE,10,12);
	GPIO_AF_Set(GPIOE,11,12);
	GPIO_AF_Set(GPIOE,12,12);
	GPIO_AF_Set(GPIOE,13,12);
	GPIO_AF_Set(GPIOE,14,12);
	GPIO_AF_Set(GPIOE,15,12);
	
	
	GPIO_AF_Set(GPIOF,0,12);
	GPIO_AF_Set(GPIOF,1,12);
	GPIO_AF_Set(GPIOF,2,12);
	GPIO_AF_Set(GPIOF,3,12);
	GPIO_AF_Set(GPIOF,4,12);
	GPIO_AF_Set(GPIOF,5,12);
	GPIO_AF_Set(GPIOF,12,12);
	GPIO_AF_Set(GPIOF,13,12);
	GPIO_AF_Set(GPIOF,14,12);
	GPIO_AF_Set(GPIOF,15,12);
	
	GPIO_AF_Set(GPIOG,0,12);
	GPIO_AF_Set(GPIOG,1,12);
	GPIO_AF_Set(GPIOG,2,12);
	GPIO_AF_Set(GPIOG,3,12);
	GPIO_AF_Set(GPIOG,4,12);
	GPIO_AF_Set(GPIOG,5,12);
		
	FSMC_Bank1->BTCR[4]|=1<<12;	//存储器写使能
	FSMC_Bank1->BTCR[4]|=1<<4; 	//存储器数据宽度为16bit
	
	FSMC_Bank1->BTCR[5]=0;
	FSMC_Bank1->BTCR[5]|=3<<8; //数据保持时间（DATAST）为9个HCLK 6*9=54ns	 	 
	FSMC_Bank1->BTCR[5]|=0<<0; //地址保持时间（ADDSET）未用到	  	 

	FSMC_Bank1->BTCR[4]|=1<<0;	//区域使能
}



